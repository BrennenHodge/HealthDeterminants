function drawNodeGraph(){var t=1360,e=180,n=d3.layout.tree().size([360,t/2-120]).separation(function(t,e){return(t.parent==e.parent?1:2)/t.depth}),r=d3.svg.diagonal.radial().projection(function(t){return[t.y,t.x/180*Math.PI]}),a=d3.select("#node").append("svg").attr("width",t+2*e).attr("height",t+2*e).append("g").attr("transform","translate("+(t/2+e)+","+(t/2+e)+")");d3.json("data/health-determinants.json",function(t,e){if(t)throw t;var l=n.nodes(e),d=n.links(l),c=a.selectAll(".link").data(d).enter().append("path").attr("class","link").attr("d",r),i=a.selectAll(".node").data(l).enter().append("g").attr("class","node").attr("transform",function(t){return"rotate("+(t.x-90)+")translate("+t.y+")"});i.append("circle").attr("r",4.5),i.append("text").attr("class","nodeText").attr("dy",".31em").attr("text-anchor",function(t){return t.x<180?"start":"end"}).attr("transform",function(t){return t.x<180?"translate(8)":"rotate(180)translate(-8)"}).text(function(t){return t.name})})}function drawTreemap(){var t={top:24,right:0,bottom:0,left:0},e=1e3,n=600-t.top-t.bottom,r=d3.format(",d"),a,l=d3.scale.linear().domain([0,e]).range([0,e]),d=d3.scale.linear().domain([0,n]).range([0,n]),c=d3.layout.treemap().children(function(t,e){return e?null:t._children}).sort(function(t,e){return t.value-e.value}).ratio(n/e*.5*(1+Math.sqrt(5))).round(!1),i=d3.select("#chart").append("svg").attr("width",e+t.left+t.right).attr("height",n+t.bottom+t.top).style("margin-left",-t.left+"px").style("margin.right",-t.right+"px").append("g").attr("transform","translate("+t.left+","+t.top+")").style("shape-rendering","crispEdges"),o=i.append("g").attr("class","grandparent");o.append("rect").attr("y",-t.top).attr("width",e).attr("height",t.top),o.append("text").attr("x",0).attr("y",0-t.top).attr("dy","1em"),d3.json("data/dataForTreemap.json",function(t){function p(t){t.x=t.y=0,t.dx=e,t.dy=n,t.depth=0}function s(t){return(t._children=t.children)?t.value=t.children.reduce(function(t,e){return t+s(e)},0):t.value}function u(t){t._children&&(c.nodes({_children:t._children}),t._children.forEach(function(e){e.x=t.x+e.x*t.dx,e.y=t.y+e.y*t.dy,e.dx*=t.dx,e.dy*=t.dy,e.parent=t,u(e)}))}function x(t){function e(t){if(!a&&t){a=!0;var e=x(t),r=n.transition().duration(750),c=e.transition().duration(750);l.domain([t.x,t.x+t.dx]),d.domain([t.y,t.y+t.dy]),i.style("shape-rendering",null),i.selectAll(".depth").sort(function(t,e){return t.depth-e.depth}),e.selectAll("text").style("fill-opacity",0),r.selectAll("text").call(f).style("fill-opacity",0),c.selectAll("text").call(f).style("fill-opacity",1),r.selectAll("rect").call(h),c.selectAll("rect").call(h),r.remove().each("end",function(){i.style("shape-rendering","crispEdges"),a=!1})}}o.datum(t.parent).on("click",e).select("text").text(y(t));var n=i.insert("g",".grandparent").datum(t).attr("class","depth"),c=n.selectAll("g").data(t._children).enter().append("g");return c.filter(function(t){return t._children}).classed("children",!0).on("click",e),c.selectAll(".child").data(function(t){return t._children||[t]}).enter().append("rect").attr("class","child").call(h),c.append("rect").attr("class","parent").call(h).append("title").text(function(t){return r(t.value)}),c.append("text").attr("dy","15px").attr("dx","5px").attr("font-size","16px").text(function(t){return t.name}).call(f),c.append("text").attr("dy","35px").attr("dx","5px").attr("font-size","14px").text(function(t){return t.source?"source: ":void 0}).call(f),c.append("text").attr("dy","55px").attr("dx","5px").attr("font-size","14px").text(function(t){return t.source}).call(f),c.append("text").attr("dy","75px").attr("dx","5px").attr("font-size","14px").text(function(t){return t.source2}).call(f),c.append("text").attr("dy","95px").attr("dx","5px").attr("font-size","14px").text(function(t){return t.source3}).call(f),c.append("text").attr("dy","115px").attr("dx","5px").attr("font-size","14px").text(function(t){return t.source4}).call(f),c}function f(t){t.attr("x",function(t){return l(t.x)+6}).attr("y",function(t){return d(t.y)+6})}function h(t){var e=d3.scale.category20c();t.attr("x",function(t){return l(t.x)}).attr("y",function(t){return d(t.y)}).attr("width",function(t){return l(t.x+t.dx)-l(t.x)}).attr("height",function(t){return d(t.y+t.dy)-d(t.y)})}function y(t){return t.parent?y(t.parent)+" / "+t.name:t.name}p(t),s(t),u(t),x(t)})}function drawHorizontalTree(){var t=800,e=2e3,n=d3.layout.cluster().size([e,t-160]),r=d3.svg.diagonal().projection(function(t){return[t.y,t.x]}),a=d3.select("#horizontal-tree").append("svg").attr("width",1e3).attr("height",e).append("g").attr("transform","translate(45,0)");d3.json("data/dataForTreemap.json",function(t,e){if(t)throw t;var l=n.nodes(e),d=n.links(l),c=a.selectAll(".link").data(d).enter().append("path").attr("class","link").attr("d",r),i=a.selectAll(".node").data(l).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.y+","+t.x+")"});i.append("circle").attr("r",4.5),i.append("text").attr("dx",function(t){return t.children?-8:8}).attr("dy",3).style("text-anchor",function(t){return t.children?"end":"start"}).text(function(t){return t.name})}),d3.select(self.frameElement).style("height",e+"px")}